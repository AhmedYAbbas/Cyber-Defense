using System;
using UnityEngine;
using UnityEngine.AI;

public class Malware : MonoBehaviour
{
    // Private
    [SerializeField] private MalwareData _malwareData;
    private NavMeshAgent _malware;


    // Public 
    [HideInInspector] public string Name;
    [HideInInspector] public int AttackDamage;
    [HideInInspector] public int MovementSpeed;
    [HideInInspector] public int Health;
    [HideInInspector] public int Shield;
    [HideInInspector] public int EnergyCost;
    [HideInInspector] public bool IsRanged;
    private int _currentHealth;

    void Start()
    {
        _malware = GetComponent<NavMeshAgent>();
        this.GetComponent<Renderer>().material.color = _malwareData.CardColor;
        name = _malwareData.MalwareName;
        AttackDamage = _malwareData.AttackDamage;
        MovementSpeed = _malwareData.MovementSpeed;
        EnergyCost = _malwareData.EnergyCost;
        Health = _malwareData.Health;
        Shield = _malwareData.Shield;
        IsRanged = _malwareData.IsRanged;
        _malware.speed = MovementSpeed;
        _currentHealth = Health;
    }

    private void OnEnable()
    {
        _currentHealth = Health;
    }

    public void DamageMalware(int dmg)
    {
        _currentHealth -= dmg;
        if (_currentHealth <= 0)
        {
            gameObject.SetActive(false);
        }
    }
}